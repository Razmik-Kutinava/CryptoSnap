<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            background: #2481cc;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        .btn:hover {
            background: #1c6ba0;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .code {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            overflow-x: auto;
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot</h1>
        
        <div class="info">
            <strong>–¢–æ–∫–µ–Ω –±–æ—Ç–∞:</strong> 8485812370:AAGVm0q_CCzcS6HflE4uc8AFXbRt0ECEFIM
        </div>

        <h2>üìã –®–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</h2>
        
        <div>
            <h3>1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å API:</h3>
            <button class="btn" onclick="checkBotStatus()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞</button>
            <div id="botStatus"></div>
        </div>

        <div>
            <h3>2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhook:</h3>
            <button class="btn" onclick="setupWebhook()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhook</button>
            <div id="webhookStatus"></div>
        </div>

        <div>
            <h3>3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Webhook:</h3>
            <button class="btn" onclick="getWebhookInfo()">üì° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Webhook</button>
            <div id="webhookInfo"></div>
        </div>

        <div>
            <h3>4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞:</h3>
            <p>–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook:</p>
            <ol>
                <li>–ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram –ø–æ —Ç–æ–∫–µ–Ω—É</li>
                <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É <code>/start</code></li>
                <li>–î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ "üöÄ –û—Ç–∫—Ä—ã—Ç—å –ö—Ä–∏–ø—Ç–æ –¢–∞–±–ª–æ"</li>
            </ol>
        </div>

        <h2>üîß –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h2>
        <div class="code">
            <strong>Webhook URL:</strong> https://crypto-snap-lilac.vercel.app/api/bot<br>
            <strong>Web App URL:</strong> https://crypto-snap-lilac.vercel.app<br>
            <strong>Telegram API:</strong> https://api.telegram.org/bot8485812370:AAGVm0q_CCzcS6HflE4uc8AFXbRt0ECEFIM/
        </div>
    </div>

    <script>
        async function checkBotStatus() {
            const status = document.getElementById('botStatus');
            status.innerHTML = '<div class="info">üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞...</div>';
            
            try {
                const response = await fetch('/api/bot');
                const data = await response.json();
                
                if (response.ok) {
                    status.innerHTML = `<div class="success">‚úÖ Bot API —Ä–∞–±–æ—Ç–∞–µ—Ç!<br>–í—Ä–µ–º—è: ${data.timestamp}</div>`;
                } else {
                    status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}</div>`;
            }
        }

        async function setupWebhook() {
            const status = document.getElementById('webhookStatus');
            status.innerHTML = '<div class="info">üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook...</div>';
            
            try {
                const response = await fetch('/api/setup-webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    status.innerHTML = `<div class="success">‚úÖ Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω!<br>URL: ${data.webhook_url}</div>`;
                } else {
                    status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        async function getWebhookInfo() {
            const status = document.getElementById('webhookInfo');
            status.innerHTML = '<div class="info">üîÑ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</div>';
            
            try {
                const response = await fetch('https://api.telegram.org/bot8485812370:AAGVm0q_CCzcS6HflE4uc8AFXbRt0ECEFIM/getWebhookInfo');
                const data = await response.json();
                
                if (data.ok) {
                    const info = data.result;
                    status.innerHTML = `
                        <div class="success">
                            <strong>‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Webhook:</strong><br>
                            URL: ${info.url || '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}<br>
                            –û–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: ${info.pending_update_count}<br>
                            –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: ${info.last_error_message || '–ù–µ—Ç'}<br>
                            –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—à–∏–±–∫–∏: ${info.last_error_date ? new Date(info.last_error_date * 1000).toLocaleString() : '–ù–µ—Ç'}
                        </div>
                    `;
                } else {
                    status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.description}</div>`;
                }
            } catch (error) {
                status.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>